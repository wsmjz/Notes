<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>源码认识 | 苹果家+</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="汇聚百川，终成江河">
    <link rel="preload" href="/assets/css/0.styles.470a3808.css" as="style"><link rel="preload" href="/assets/js/app.de1d81cd.js" as="script"><link rel="preload" href="/assets/js/2.c2305d67.js" as="script"><link rel="preload" href="/assets/js/24.535e2208.js" as="script"><link rel="prefetch" href="/assets/js/10.ea7cb643.js"><link rel="prefetch" href="/assets/js/11.a11503fd.js"><link rel="prefetch" href="/assets/js/12.8f4b0af7.js"><link rel="prefetch" href="/assets/js/13.68a19f50.js"><link rel="prefetch" href="/assets/js/14.0bf1eb19.js"><link rel="prefetch" href="/assets/js/15.91626234.js"><link rel="prefetch" href="/assets/js/16.2b71a137.js"><link rel="prefetch" href="/assets/js/17.3b78bd93.js"><link rel="prefetch" href="/assets/js/18.b93534bb.js"><link rel="prefetch" href="/assets/js/19.98089146.js"><link rel="prefetch" href="/assets/js/20.597cf61a.js"><link rel="prefetch" href="/assets/js/21.230ef33e.js"><link rel="prefetch" href="/assets/js/22.6012955a.js"><link rel="prefetch" href="/assets/js/23.3b9e0fd2.js"><link rel="prefetch" href="/assets/js/25.9d93ae40.js"><link rel="prefetch" href="/assets/js/26.e8c62349.js"><link rel="prefetch" href="/assets/js/27.aa40645a.js"><link rel="prefetch" href="/assets/js/28.15d65c15.js"><link rel="prefetch" href="/assets/js/29.3bf54ac5.js"><link rel="prefetch" href="/assets/js/3.9ada7847.js"><link rel="prefetch" href="/assets/js/30.9f88906b.js"><link rel="prefetch" href="/assets/js/31.f78e0c14.js"><link rel="prefetch" href="/assets/js/32.405ceaf7.js"><link rel="prefetch" href="/assets/js/33.89e28487.js"><link rel="prefetch" href="/assets/js/34.6b58d7cd.js"><link rel="prefetch" href="/assets/js/35.d689a4cf.js"><link rel="prefetch" href="/assets/js/36.6259c160.js"><link rel="prefetch" href="/assets/js/37.eb3afbbe.js"><link rel="prefetch" href="/assets/js/38.4f3c72fa.js"><link rel="prefetch" href="/assets/js/39.59401d97.js"><link rel="prefetch" href="/assets/js/4.9848ea20.js"><link rel="prefetch" href="/assets/js/40.e5127ddd.js"><link rel="prefetch" href="/assets/js/41.cde46c4f.js"><link rel="prefetch" href="/assets/js/42.5a987bae.js"><link rel="prefetch" href="/assets/js/43.ce2bbfd2.js"><link rel="prefetch" href="/assets/js/44.e58cef39.js"><link rel="prefetch" href="/assets/js/45.5bdd2afc.js"><link rel="prefetch" href="/assets/js/46.cd5722fb.js"><link rel="prefetch" href="/assets/js/47.3e3d0c14.js"><link rel="prefetch" href="/assets/js/48.05bea5d4.js"><link rel="prefetch" href="/assets/js/5.e6d11cb5.js"><link rel="prefetch" href="/assets/js/6.5451d423.js"><link rel="prefetch" href="/assets/js/7.37e814f9.js"><link rel="prefetch" href="/assets/js/8.2424fb21.js"><link rel="prefetch" href="/assets/js/9.3efe92d5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.470a3808.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">苹果家+</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="UI组件生态" class="dropdown-title"><span class="title">UI组件生态</span> <span class="arrow down"></span></button> <button type="button" aria-label="UI组件生态" class="mobile-dropdown-title"><span class="title">UI组件生态</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/components/jg/button.html" class="nav-link">
  结构组件
</a></li><li class="dropdown-item"><!----> <a href="/components/yw/note.html" class="nav-link">
  业务组件
</a></li><li class="dropdown-item"><!----> <a href="/components/lc/note.html" class="nav-link">
  流程图组件
</a></li><li class="dropdown-item"><!----> <a href="/components/button.html" class="nav-link">
  地图组件
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生态系统" class="dropdown-title"><span class="title">生态系统</span> <span class="arrow down"></span></button> <button type="button" aria-label="生态系统" class="mobile-dropdown-title"><span class="title">生态系统</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          项目
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ecology/admin/vue.html" class="nav-link">
  ping-vue(简版vue)
</a></li><li class="dropdown-subitem"><a href="/ecology/admin/vue.html" class="nav-link">
  ping-react(简版react)
</a></li><li class="dropdown-subitem"><a href="/ecology/inst.html" class="nav-link">
  ping-offical-vue(响应式)
</a></li><li class="dropdown-subitem"><a href="/ecology/inst.html" class="nav-link">
  ping-xcx
</a></li><li class="dropdown-subitem"><a href="/ecology/inst.html" class="nav-link">
  H5商城
</a></li></ul></li><li class="dropdown-item"><h4>
          资源
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/components/jg/button.html" class="nav-link">
  UI库-vue
</a></li><li class="dropdown-subitem"><a href="/ecology/dev/devtools.html" class="nav-link">
  基础资源ping-base-lib
</a></li><li class="dropdown-subitem"><a href="/ecology/cli/cli.html" class="nav-link">
  pi(核心，自动化配置)
</a></li><li class="dropdown-subitem"><a href="/ecology/cli/cli.html" class="nav-link">
  脚手架ping-cli
</a></li><li class="dropdown-subitem"><a href="/ecology/webpack.html" class="nav-link">
  打包工具ping-webpack
</a></li><li class="dropdown-subitem"><a href="/ecology/schema.html" class="nav-link">
  校验库
</a></li><li class="dropdown-subitem"><a href="/ecology/schema.html" class="nav-link">
  状态管理
</a></li><li class="dropdown-subitem"><a href="/ecology/schema.html" class="nav-link">
  路由
</a></li><li class="dropdown-subitem"><a href="/ecology/schema.html" class="nav-link">
  日期
</a></li><li class="dropdown-subitem"><a href="/ecology/schema.html" class="nav-link">
  图表
</a></li><li class="dropdown-subitem"><a href="/ecology/schema.html" class="nav-link">
  地图
</a></li><li class="dropdown-subitem"><a href="/ecology/schema.html" class="nav-link">
  关系流程图
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="核心" class="dropdown-title"><span class="title">核心</span> <span class="arrow down"></span></button> <button type="button" aria-label="核心" class="mobile-dropdown-title"><span class="title">核心</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Core/Api/base.html" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/Core/V8/base.html" class="nav-link">
  js(v8)引擎
</a></li><li class="dropdown-item"><!----> <a href="/Core/Achieve/base.html" class="nav-link">
  原理实现
</a></li><li class="dropdown-item"><!----> <a href="/Core/Vue/base.html" class="nav-link">
  Vue概记
</a></li><li class="dropdown-item"><!----> <a href="/Core/React/base.html" class="nav-link">
  React概记
</a></li><li class="dropdown-item"><!----> <a href="/Core/MyWebpack/base.html" class="nav-link">
  webpack
</a></li></ul></div></div><div class="nav-item"><a href="/xingneng/base.html" class="nav-link">
  性能优化
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="可视化" class="dropdown-title"><span class="title">可视化</span> <span class="arrow down"></span></button> <button type="button" aria-label="可视化" class="mobile-dropdown-title"><span class="title">可视化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Cansee/three.html" class="nav-link">
  three.js
</a></li><li class="dropdown-item"><!----> <a href="/Cansee/D3.html" class="nav-link">
  D3
</a></li></ul></div></div><div class="nav-item"><a href="/zaji/js/base.html" class="nav-link">
  杂记
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="进阶" class="dropdown-title"><span class="title">进阶</span> <span class="arrow down"></span></button> <button type="button" aria-label="进阶" class="mobile-dropdown-title"><span class="title">进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/jingjie/sjjg.html" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/jingjie/suanfa/base.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/jingjie/base.html" class="nav-link">
  node
</a></li><li class="dropdown-item"><!----> <a href="/Core/React/.html" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/Core/React/.html" class="nav-link">
  python
</a></li></ul></div></div> <a href="https://github.com/wsmjz" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="UI组件生态" class="dropdown-title"><span class="title">UI组件生态</span> <span class="arrow down"></span></button> <button type="button" aria-label="UI组件生态" class="mobile-dropdown-title"><span class="title">UI组件生态</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/components/jg/button.html" class="nav-link">
  结构组件
</a></li><li class="dropdown-item"><!----> <a href="/components/yw/note.html" class="nav-link">
  业务组件
</a></li><li class="dropdown-item"><!----> <a href="/components/lc/note.html" class="nav-link">
  流程图组件
</a></li><li class="dropdown-item"><!----> <a href="/components/button.html" class="nav-link">
  地图组件
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生态系统" class="dropdown-title"><span class="title">生态系统</span> <span class="arrow down"></span></button> <button type="button" aria-label="生态系统" class="mobile-dropdown-title"><span class="title">生态系统</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          项目
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ecology/admin/vue.html" class="nav-link">
  ping-vue(简版vue)
</a></li><li class="dropdown-subitem"><a href="/ecology/admin/vue.html" class="nav-link">
  ping-react(简版react)
</a></li><li class="dropdown-subitem"><a href="/ecology/inst.html" class="nav-link">
  ping-offical-vue(响应式)
</a></li><li class="dropdown-subitem"><a href="/ecology/inst.html" class="nav-link">
  ping-xcx
</a></li><li class="dropdown-subitem"><a href="/ecology/inst.html" class="nav-link">
  H5商城
</a></li></ul></li><li class="dropdown-item"><h4>
          资源
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/components/jg/button.html" class="nav-link">
  UI库-vue
</a></li><li class="dropdown-subitem"><a href="/ecology/dev/devtools.html" class="nav-link">
  基础资源ping-base-lib
</a></li><li class="dropdown-subitem"><a href="/ecology/cli/cli.html" class="nav-link">
  pi(核心，自动化配置)
</a></li><li class="dropdown-subitem"><a href="/ecology/cli/cli.html" class="nav-link">
  脚手架ping-cli
</a></li><li class="dropdown-subitem"><a href="/ecology/webpack.html" class="nav-link">
  打包工具ping-webpack
</a></li><li class="dropdown-subitem"><a href="/ecology/schema.html" class="nav-link">
  校验库
</a></li><li class="dropdown-subitem"><a href="/ecology/schema.html" class="nav-link">
  状态管理
</a></li><li class="dropdown-subitem"><a href="/ecology/schema.html" class="nav-link">
  路由
</a></li><li class="dropdown-subitem"><a href="/ecology/schema.html" class="nav-link">
  日期
</a></li><li class="dropdown-subitem"><a href="/ecology/schema.html" class="nav-link">
  图表
</a></li><li class="dropdown-subitem"><a href="/ecology/schema.html" class="nav-link">
  地图
</a></li><li class="dropdown-subitem"><a href="/ecology/schema.html" class="nav-link">
  关系流程图
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="核心" class="dropdown-title"><span class="title">核心</span> <span class="arrow down"></span></button> <button type="button" aria-label="核心" class="mobile-dropdown-title"><span class="title">核心</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Core/Api/base.html" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/Core/V8/base.html" class="nav-link">
  js(v8)引擎
</a></li><li class="dropdown-item"><!----> <a href="/Core/Achieve/base.html" class="nav-link">
  原理实现
</a></li><li class="dropdown-item"><!----> <a href="/Core/Vue/base.html" class="nav-link">
  Vue概记
</a></li><li class="dropdown-item"><!----> <a href="/Core/React/base.html" class="nav-link">
  React概记
</a></li><li class="dropdown-item"><!----> <a href="/Core/MyWebpack/base.html" class="nav-link">
  webpack
</a></li></ul></div></div><div class="nav-item"><a href="/xingneng/base.html" class="nav-link">
  性能优化
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="可视化" class="dropdown-title"><span class="title">可视化</span> <span class="arrow down"></span></button> <button type="button" aria-label="可视化" class="mobile-dropdown-title"><span class="title">可视化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Cansee/three.html" class="nav-link">
  three.js
</a></li><li class="dropdown-item"><!----> <a href="/Cansee/D3.html" class="nav-link">
  D3
</a></li></ul></div></div><div class="nav-item"><a href="/zaji/js/base.html" class="nav-link">
  杂记
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="进阶" class="dropdown-title"><span class="title">进阶</span> <span class="arrow down"></span></button> <button type="button" aria-label="进阶" class="mobile-dropdown-title"><span class="title">进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/jingjie/sjjg.html" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/jingjie/suanfa/base.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/jingjie/base.html" class="nav-link">
  node
</a></li><li class="dropdown-item"><!----> <a href="/Core/React/.html" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/Core/React/.html" class="nav-link">
  python
</a></li></ul></div></div> <a href="https://github.com/wsmjz" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>react概记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>源码认识</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Core/React/yuanli.html" aria-current="page" class="active sidebar-link">源码认识</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Core/React/yuanli.html#redux" class="sidebar-link">redux</a></li><li class="sidebar-sub-header"><a href="/Core/React/yuanli.html#中间件" class="sidebar-link">中间件</a></li><li class="sidebar-sub-header"><a href="/Core/React/yuanli.html#多引入" class="sidebar-link">多引入</a></li><li class="sidebar-sub-header"><a href="/Core/React/yuanli.html#功能件" class="sidebar-link">功能件</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>生态</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="源码认识"><a href="#源码认识" class="header-anchor">#</a> 源码认识</h1> <ul><li><p>class类</p> <ul><li>一篇彻底理解，串联这些枯燥又易混淆的概念<code>原型链(原型对象，各种指针，实例，构造函数之间的关系，其实就是一种对象间的赋值关系，就想平常自己写的那样)与堆栈及应用</code>，比如call, new,源码，插件中的应用（确定this指向），需要改变这个就改变哪个的时候，用到原型链重新赋值</li> <li>基本语法
<ul><li>静态方法</li> <li>实例属性的新写法</li> <li>静态属性</li> <li>私有方法和私有属性</li> <li>new.target属性</li></ul></li> <li>继承
<ul><li>Object.getPrototypeOf()</li> <li>constructor，supur</li> <li>类的 prototype 属性和__proto__属性</li> <li>实例的 <strong>proto</strong> 属性
<ul><li>子类实例的__proto__属性的__proto__属性，指向父类实例的__proto__属性。也就是说，子类的原型的原型，是父类的原型</li> <li>应用，结果：<code>因此，通过子类实例的__proto__.__proto__属性，可以修改父类实例的行为。</code>, 这样改变类子类的这个就同步改变类父类的那个（对象在堆中存放的指针）<img src="yxl.png" alt=""></li></ul></li> <li>原生构造函数的继承
<ul><li>以前，这些原生构造函数是无法继承的，比如，不能自己定义一个Array的子类。</li> <li>ES5 是先新建子类的实例对象this，再将父类的属性添加到子类上，由于父类的内部属性无法获取，导致无法继承原生的构造函数</li> <li>ES6 允许继承原生构造函数定义子类，因为 ES6 是先新建父类的实例对象this，然后再用子类的构造函数修饰this，使得父类的所有行为都可以继承</li> <li>extends关键字不仅可以用来继承类，还可以用来继承原生的构造函数。因此可以在原生数据结构的基础上，定义自己的数据结构</li></ul></li> <li>Mixin 模式的实现
<ul><li>Mixin 指的是多个对象合成一个新的对象，新对象具有各个组成成员的接口</li></ul></li></ul></li></ul></li> <li><p>Es6 class constructor实现</p> <ul><li>constructor方法默认返回实例对象（即this），完全可以指定返回另外一个对象</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
     <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">return</span> <span class="token punctuation">{</span>
             name<span class="token operator">:</span> <span class="token string">'新对象'</span> <span class="token comment">// 若是返回基本数据类型.数字 instanceof还是返回true</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
<span class="token comment">// 判断谁是谁的实例</span>
<span class="token comment">// new Foo() instanceof Foo   // true</span>
<span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">Foo</span> <span class="token comment">// false</span>
</code></pre></div><ul><li>类的所有方法都定义在类的prototype属性上面。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token class-name">Point</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
     <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token function">toValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>es6类，完全可以看作构造函数的另一种写法<code>Point === Point.prototype.constructor // true</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Ani</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Ani</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre></div><ul><li>super 既可以当做函数使用，也可以当做对象使用</li></ul></li> <li><p>类组件继承实现</p></li> <li><p>super</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token keyword">extends</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>注意，super虽然代表了父类A的构造函数，但是返回的是子类B的实例，即super内部的this指的是B的实例，因此<code>super()在这里相当于A.prototype.constructor.call(this)</code>。</p> <ul><li>new的时候class中的constructor会立即执行</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>p <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// 实例上的</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token keyword">extends</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
  <span class="token keyword">get</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span>p<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
b<span class="token punctuation">.</span>m <span class="token comment">// undefined</span>
这里需要注意，由于<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">super指向父类的原型对象</span><span class="token template-punctuation string">`</span></span>，所以定义在父类实例上的方法或属性，是无法通过<span class="token keyword">super</span>调用的。
上面代码中，p是父类<span class="token constant">A</span>实例的属性，<span class="token keyword">super</span><span class="token punctuation">.</span>p就引用不到它
</code></pre></div><h2 id="redux"><a href="#redux" class="header-anchor">#</a> redux</h2> <ul><li>40：10</li> <li>combineReducers</li></ul> <h3 id="createstore"><a href="#createstore" class="header-anchor">#</a> createStore()</h3> <p>实现原理</p> <div class="language-js extra-class"><pre class="language-js"><code>
</code></pre></div><h3 id="bindactioncreators"><a href="#bindactioncreators" class="header-anchor">#</a> bindActionCreators()</h3> <p>实现原理</p> <div class="language-js extra-class"><pre class="language-js"><code>
</code></pre></div><h3 id="combinreducers"><a href="#combinreducers" class="header-anchor">#</a> combinReducers()</h3> <p>实现原理</p> <div class="language-js extra-class"><pre class="language-js"><code>
</code></pre></div><h3 id="provider"><a href="#provider" class="header-anchor">#</a> Provider()</h3> <p>供应商，提供者</p> <div class="language-js extra-class"><pre class="language-js"><code>
</code></pre></div><h3 id="connect"><a href="#connect" class="header-anchor">#</a> connect()</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">OldComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> content <span class="token operator">=</span> <span class="token function">useContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre></div><h3 id="applymiddleware"><a href="#applymiddleware" class="header-anchor">#</a> applyMiddleware()</h3> <h2 id="中间件"><a href="#中间件" class="header-anchor">#</a> 中间件</h2> <p>本质就是函数劫持，函数切片，重写dispatch方法：加入执行dispatch方法，之前，之后处理逻辑，或延迟处理<br></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// store.js 中</span>
<span class="token keyword">let</span> enhancer <span class="token operator">=</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>_routerMiddleware<span class="token punctuation">,</span> <span class="token operator">...</span>Middlewares<span class="token punctuation">.</span>middlewares<span class="token punctuation">,</span> loyaltyErrorMidware<span class="token punctuation">)</span> <span class="token comment">// applyMiddleware =》redux提供</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>rootReducer<span class="token punctuation">,</span> _initialState<span class="token punctuation">,</span> enhancer<span class="token punctuation">)</span><span class="token punctuation">;</span>

FetchRequest<span class="token punctuation">.</span><span class="token function">connectToRedux</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 统一处理提示语</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> message <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Actions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'kryfe-lib'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">errorMiddleware</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> dispatch <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token parameter">next</span> <span class="token operator">=&gt;</span> <span class="token parameter">action</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> opDecribe <span class="token operator">=</span> isENLanguage <span class="token operator">?</span> <span class="token string">'operation'</span> <span class="token operator">:</span> <span class="token string">'操作'</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> action<span class="token punctuation">.</span>messageInfo <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      opDecribe <span class="token operator">=</span> action<span class="token punctuation">.</span>messageInfo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>
      action<span class="token punctuation">.</span>error <span class="token operator">&amp;&amp;</span>
      action<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>data <span class="token operator">&amp;&amp;</span>
      action<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>data<span class="token punctuation">.</span>code <span class="token operator">!==</span> <span class="token number">30200</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      message<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>
        action<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>data <span class="token operator">&amp;&amp;</span>
        <span class="token punctuation">(</span>action<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>data<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token number">3</span> <span class="token operator">||</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>data<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        isENLanguage
          <span class="token operator">?</span> message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>message <span class="token operator">||</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>opDecribe<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> failed</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
          <span class="token operator">:</span> message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>message <span class="token operator">||</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>opDecribe<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">失败</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">dispatch</span><span class="token punctuation">(</span>Actions<span class="token punctuation">.</span><span class="token function">systemCleanError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        isENLanguage
          <span class="token operator">?</span> message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>message <span class="token operator">||</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>opDecribe<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">failed</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
          <span class="token operator">:</span> message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>message <span class="token operator">||</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>opDecribe<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">失败</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>action<span class="token punctuation">.</span>ignoreSuccess <span class="token operator">&amp;&amp;</span> action<span class="token punctuation">.</span>messageInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      message<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      isENLanguage
        <span class="token operator">?</span> message<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>opDecribe<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> success</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token operator">:</span> message<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>opDecribe<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">成功</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><ul><li>有的中间件有次序要求，使用前要查一下文档。比如，logger就一定要放在最后，否则输出结果会不正确</li> <li>级联中间件composedFn</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">add1</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'1'</span> <span class="token operator">+</span> str
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token parameter">add3<span class="token punctuation">,</span> add2<span class="token punctuation">,</span> add1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">add3</span><span class="token punctuation">(</span><span class="token function">add2</span><span class="token punctuation">(</span><span class="token function">add1</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>fns</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> fns<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> composedFn <span class="token operator">=</span> <span class="token function">compose</span><span class="token punctuation">(</span>add3<span class="token punctuation">,</span> add2<span class="token punctuation">,</span> add1<span class="token punctuation">)</span>
<span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">composedFn</span><span class="token punctuation">(</span><span class="token string">'hahh'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="koa"><a href="#koa" class="header-anchor">#</a> koa</h3> <ul><li>reduce实现</li> <li>中间件基于koa 仿照</li></ul> <h3 id="日志中间件logger"><a href="#日志中间件logger" class="header-anchor">#</a> 日志中间件logger</h3> <h3 id="thunk"><a href="#thunk" class="header-anchor">#</a> thunk</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">promise</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>dispatch<span class="token punctuation">,</span> getState<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> action <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">action</span><span class="token punctuation">(</span>dispatch<span class="token punctuation">,</span> getState<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="promise"><a href="#promise" class="header-anchor">#</a> promise</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">promise</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>dispatch<span class="token punctuation">,</span> getState<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> action<span class="token punctuation">.</span>then <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 说明外面传了一个promise</span>
        action<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>dispatch<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="routermiddleware"><a href="#routermiddleware" class="header-anchor">#</a> routerMiddleware</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> routerMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-router-redux'</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="多引入"><a href="#多引入" class="header-anchor">#</a> 多引入</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> getLocale<span class="token punctuation">,</span> <span class="token punctuation">{</span> getLocaleFolder<span class="token punctuation">,</span> antdLans <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'shared/utils/getLocale'</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> antdZhCn <span class="token keyword">from</span> <span class="token string">'antd/lib/locale-provider/zh_CN'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> antdEnUs <span class="token keyword">from</span> <span class="token string">'antd/lib/locale-provider/en_US'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> EnUs <span class="token operator">=</span> <span class="token string">'en_US'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ZhCn <span class="token operator">=</span> <span class="token string">'zh_CN'</span><span class="token punctuation">;</span>

<span class="token comment">/* 国际化 */</span>
<span class="token keyword">function</span> <span class="token function">getCookie</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> arr<span class="token punctuation">,</span>
    reg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">'(^| )'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'=([^;]*)(;|$)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>arr <span class="token operator">=</span> document<span class="token punctuation">.</span>cookie<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">unescape</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">getLocale</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 国际化 */</span>
  <span class="token comment">// const locale = __SERVER__ ? global.__LOCALE__ : window.navigator.language;</span>
  <span class="token keyword">let</span> locale <span class="token operator">=</span> <span class="token function">getCookie</span><span class="token punctuation">(</span><span class="token string">'language'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'locale---'</span><span class="token punctuation">,</span> locale<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>locale <span class="token operator">===</span> <span class="token string">'en_GB'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    locale <span class="token operator">=</span> <span class="token string">'en'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> locale <span class="token operator">||</span> <span class="token string">'zh'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getLocaleFolder</span><span class="token punctuation">(</span><span class="token parameter">locale</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>locale<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'en'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> EnUs<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'zh'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> ZhCn<span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> ZhCn<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> antdLans <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>ZhCn<span class="token punctuation">]</span><span class="token operator">:</span> antdZhCn<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>EnUs<span class="token punctuation">]</span><span class="token operator">:</span> antdEnUs<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="功能件"><a href="#功能件" class="header-anchor">#</a> 功能件</h2> <ul><li>可以对这个类做增强</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Loading <span class="token keyword">from</span> <span class="token string">'shared/components/Loading'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">LoadingOrError</span><span class="token punctuation">(</span><span class="token parameter">InComponent<span class="token punctuation">,</span> needLogin <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> showError <span class="token operator">=</span> <span class="token boolean">true</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">class</span> <span class="token class-name">ContainerComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> hasLoginInfo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>loginInfo <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>loginInfo<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'brand'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> loginJudgeEnd <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>loginInfo<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'loginJudgeEnd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
          <span class="token punctuation">{</span>
            <span class="token operator">!</span>needLogin <span class="token operator">||</span> hasLoginInfo<span class="token operator">?</span>
            <span class="token operator">&lt;</span>InComponent <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token operator">:</span> <span class="token keyword">null</span>
          <span class="token punctuation">}</span>
          <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>loaingStatus <span class="token operator">?</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>Loading <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      loginInfo<span class="token operator">:</span> state<span class="token punctuation">.</span>baseApi<span class="token punctuation">.</span>loginInfo<span class="token punctuation">,</span>
      loaingStatus<span class="token operator">:</span> state<span class="token punctuation">.</span>__system__<span class="token punctuation">.</span>loading<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      errorType<span class="token operator">:</span> state<span class="token punctuation">.</span>__system__<span class="token punctuation">.</span>error<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">(</span>ContainerComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><ul><li>使用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">LoadOrError</span><span class="token punctuation">(</span>AllCardList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/23/2020, 9:50:28 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Core/React/wenti.html" class="prev">
        常见问题
      </a></span> <span class="next"><a href="/Core/React/ecology.html">
        react生态
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.de1d81cd.js" defer></script><script src="/assets/js/2.c2305d67.js" defer></script><script src="/assets/js/24.535e2208.js" defer></script>
  </body>
</html>
